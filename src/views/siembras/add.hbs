<div class="container p-4">
    <h2><center>Siembras</center></h2>
    <h3><center>Agrega un nuevo producto </center></h3>
    <div class="row">
        <div class="col-md-12 mx-auto">
            <div class="card ">
                <div class="card-body">
                    <form action="/inventario/add" method="POST">
                        <div class="form-group m-3">
                            <input type="text" class="form-control" name="nombre_pro"  placeholder="Nombre producto" autofocus>
                        </div>
                        <div class="form-group m-3">
                            <input type="text" class="form-control" name="cantidad" placeholder="Cantidad">
                        </div>
                        <div class="form-group m-3">
                            <input type="checkbox" name="descripcion_cant" value="Kg">
                            <label for="kg">Kg</label>
                            <input type="checkbox" name="descripcion_cant" value="Piezas">
                            <label for="kg">Piezas</label>
                        </div>
                        <p class="p-2">Genero producto</p>
                        <div class="form-group m-3">
                            <input type="checkbox" class="" name="genero" value="Frutas y verduras" />
                            <label for="Frutas y verduras">Frutas y verduras</label>
                        </div>
                        <div class="form-group m-3">
                            <input type="checkbox" class="" name="genero" value="Carnes" />
                            <label for="Carnes">Carnes</label>
                        </div>
                        <div class="form-group m-3">
                            <input type="checkbox" class="" name="genero" value="Lácteos" />
                            <label for="Lácteos">Lacteos</label>
                        </div>
                        <div class="form-group m-3">
                            <input type="checkbox" class="" name="genero" value="Panes y cereales" />
                            <label for="Panes y cereales">Panes y cereales</label>
                        </div>
                        <div class="form-group m-3">
                            <input type="checkbox" class="" name="genero" value="Limpieza" />
                            <label for="Limpieza">Limpieza</label>
                        </div>
                        <div class="form-group m-3">
                            <input type="checkbox" class="" name="genero" value="Utencilios" />
                            <label for="Utencilios">Utencilios (Platos, Cucharas, Tenedores, Cuchillos, etc)</label>
                        </div>
                        <div class="form-group m-3">
                            <input type="text" class="form-control" autocomplete="off" name="nombresSi" id="search-persona" placeholder="Nombre sembrador">
                            <ul class="autocomplete-results bg-black text-light" id="users">
                            </ul>
                        </div>
                        <div class="form-group m-3">
                            <input type="text" class="form-control" name="a_paterno" placeholder="Apellido paterno sembrador">
                        </div>
                        <div class="form-group m-3">
                            <input type="text" class="form-control" name="a_materno" placeholder="Apellido materno sembrador">
                        </div>
                        <div class="form-group m-3">
                            <input type="text" class="form-control" name="recibe" placeholder="Nombre recibe">
                        </div>
                        <div class="form-group m-3">
                            <input type="datetime-local" class="form-control" name="fecha_recibe" placeholder="Nombre sembrador">
                        </div>
                        <div class="form-control justify-content-center">
                            <button class="btn btn-outline-success btn-lg btn-block">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    let input = document.getElementById("search-persona");
    let userList = document.getElementById("users");
    let users = [];    

    window.addEventListener('DOMContentLoaded', async()=>{
    const data = await loadUsers();
    users = data;
    renderUsers(users)
    });
    
    
    input.addEventListener("keyup", (event) => {
        const newUsers = users.filter(user => `${user.nombres_persona.toLowerCase()} ${user.a_paterno.toLowerCase()}`.includes(input.value.toLowerCase()));
        renderUsers(newUsers); 
    });

    

    const loadUsers = async ()=>{
       const response = await fetch('/registropersonas/all');
       return await response.json();
    }

    const createUserItems = users => users.map(user => `<a><li>${user.nombres_persona} ${user.a_paterno} ${user.a_materno}</li></a>`).join(' ');

    const renderUsers = (users)=>{
        const itemsString = createUserItems(users);
        userList.innerHTML = itemsString;
    };
</script>